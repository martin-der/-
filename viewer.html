<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	
	<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
	<link rel="stylesheet" href="https://cdn.rawgit.com/martin-work/web-util/master/static/css/common.css" />
	<script type="text/javascript" src="https://cdn.rawgit.com/martin-work/web-util/master/static/js/misc.js"></script>
	<link rel="stylesheet" href="css/viewer.css" />
	<link rel="stylesheet" href="https://cdn.rawgit.com/martin-work/web-util/master/static/css/stackedit/export.css" />
	<script type="text/javascript" src="js/js.cookie.js"></script>
	<script type="text/javascript" src="js/mdu.js"></script>


	<script type="text/javascript" src="js/jquery-3.1.0.min.js"></script>
	<script type="text/javascript" src="js/jquery.blockUI.js"></script>
	<script src="js/jquery.growl.js" type="text/javascript"></script>
	<link href="css/jquery.growl.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="js/mustache.min.js"></script>
	<script type="text/javascript" src="js/showdown.min.js"></script>
	<script type="text/javascript" src="js/markdown-display.js"></script>
	<!--link rel="stylesheet" href="css/markdown.css"></script-->

	<script type="text/javascript" src="js/theme.js"></script>
	<link id="theme_reset_css" rel="stylesheet" href="theme/reset.css" />
	<link id="theme_main_css" rel="stylesheet" href="theme/subtle/main.css" />
	<link id="theme_mandatory_css" rel="stylesheet" href="theme/mandatory.css" />

	<script src="js/jspdf.min.js"></script>
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>

</head>
<body>

	<script id="markdown-display_on-the-fly-loader" ></script>
 
	<script  type="text/javascript">
	//<![CDATA[

		var useHistory = window.onpopstate && window.history.pushState;
		
		jQuery(function() {    
			var markdownBuilder = null;
	
			if (useHistory) {
				window.onpopstate = function(event) {
					markdownBuilder.buildPage(event.state.content,event.state.title, markdownBuilder.config.content.target.content_selector, markdownBuilder.config.content.target.title_selector);
				};
			}

			var content_selector = "div.container>div.content";
			var title_selector = "span.title";
			var all_selector = content_selector+","+title_selector;

			var blockUI_config = {
				message : null,
				fadeIn  : 0,
				fadeOut : 1500,
				overlayCSS : {
					backgroundColor : '#fff',
					opacity : 1
				}
			};

			var build_result;

			var specialElementHandlers = {
				'#tools': function (element,renderer) {
					return true;
				}
			};

			jQuery('#download').click(function () {
				var doc = new jsPDF();
				doc.fromHTML(jQuery('div#exported-content').html(), 15, 15, {
					'width': 170,'elementHandlers': specialElementHandlers
				});
				doc.save((build_result?build_result.title:'untitled')+'.pdf');
			}).css('cursor','pointer');
			
			//var markdown_source = MarkdownDisplay.BuilderUtil.getURLParameter('md');
			//if (markdown_source) {
				markdownBuilder = new MarkdownDisplay.Builder({
					content : {
						source : {
							url_parameter : 'md'
						},
						target : {
							title_selector : title_selector,
							content_selector : content_selector
						}
					},
					post_process : {
						done : function(url,content) {
							jQuery(content_selector).find('pre>code').each(function(i, block) {
								hljs.highlightBlock(block);
							});
							jQuery(all_selector).css('visibility','visible').unblock(blockUI_config);
							jQuery(content_selector).find("a[href]").each(function(){
								var this_a = jQuery(this);
								var href = this_a.attr('href');
								var isAbsolute = MDU.isAbsoluteURL(href);

								var real_url;
								if (isAbsolute) {
									real_url = href;
								} else {
									if (href.startsWith('/')) {
										var doc_location = MDU.getLocation(url);
										real_url = doc_location.protocol + '//' + doc_location.host + href;
									} else {
										var base_url = url.substring(0, url.lastIndexOf("/"));
										real_url = base_url+'/'+href;
									}
								}

								if (MarkdownDisplay.BuilderUtil.hasMDSuffix(href)) {
									this_a.attr("href","viewer+"+real_url);
									this_a.addClass('md-viewer');
									this_a.on('click', function(event) {
										if (event.which == 1) {
											event.preventDefault();
											var result = markdownBuilder.build({content:{source:{text:null, url_parameter:null, url:real_url}}});
											if (useHistory) {
												try {
													window.history.pushState(result, result.title, location.protocol + '//' + location.host + location.pathname+"?md="+real_url);
												} catch (ex) {
													jQuery.growl.warning({title: 'No history', message: ex});
												}
											}
										}
									});
								} else {
									this_a.attr("href",real_url);
								}
							});
						},
						fail : function(url, error) {
							jQuery.growl.error({ title: "Load failed", message: "Loading '"+url+"' : "+error });
						}
					}
				});
				jQuery(all_selector).css('visibility','hidden').block(blockUI_config);

				build_result = markdownBuilder.build();
			//}
		});
	//]]>
	</script>

	<div id="exported-content" style="text-align: center">
		<div style="display: inline-block; text-align: initial;">
			<table>
				<tr>
					<td>
						<header class="main-container" style="text-align: center">

							<div id="tools" class="reverse-boo" style="float : right;">
								<table>
									<tr>
										<td colspan="2">
											<select id="theme">
												<option value="country">Country</option>
												<option value="deepocean">Deep Ocean</option>
												<option value="essay">Essay</option>
												<option value="galactic">Galactic</option>
												<option value="google">Google</option>
												<option value="stoneage">Stone Age</option>
												<option value="subtle">Subtle</option>
												<option value="terminal">Terminal</option>
											</select>
										</td>
									</tr>
									<tr>
										<td>
											<a id="share">Sh</a>
										</td>
										<td>
											<a id="download">Dl</a>
										</td>
									</tr>
								</table>
							</div>

							<div style="display: inline-block; text-align: initial;">
								<table>
									<tr>
										<td>
											<!--img src="image/theme/logo-50px.png?raw" /-->
										</td>
										<td>
											<h1 class="title"><span class="title"></span></h1>
										</td>
										<td>
											<!--img src="image/theme/logo-50px.png" /-->
										</td>
									</tr>
								</table>
							</div>
						</header>
					</td>
				</tr>
				<tr>
					<td>
						<div class="main-container container"><div class="content markdown"></div></div>
					</td>
				</tr>
				<tr>
					<td>
						<footer class="main-container reverse-boo" style="font-size: 0.8em; text-align : center" >
							<span>
								Martin Der <br/>
								bla bla bla
							</span>
						</footer>
					</td>
				</tr>
			</table>
		</div>
	</div>
</body>
</html>
