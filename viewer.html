<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	
	<!--script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script-->
	<link rel="stylesheet" href="https://cdn.rawgit.com/martin-work/web-util/master/static/css/common.css" />
	<script type="text/javascript" src="https://cdn.rawgit.com/martin-work/web-util/master/static/js/misc.js"></script>
	<link rel="stylesheet" href="css/viewer.css" />
	<link rel="stylesheet" href="https://cdn.rawgit.com/martin-work/web-util/master/static/css/stackedit/export.css" />
	<script type="text/javascript" src="js/js.cookie.js"></script>
	<script type="text/javascript" src="js/mdu.js"></script>



	<script type="text/javascript" src="js/jquery-3.1.0.min.js"></script>
	<script type="text/javascript" src="js/jquery.blockUI.js"></script>
	<script src="js/jquery.growl.js" type="text/javascript"></script>
	<link href="css/jquery.growl.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="js/mustache.min.js"></script>
	<script type="text/javascript" src="js/jss.js"></script>
	<!--script type="text/javascript" src="js/showdown.min.js"></script-->

	<script type="text/javascript" src="js/Markdown.Converter.js"></script>
	<script type="text/javascript" src="js/Markdown.Sanitizer.js"></script>
	<script type="text/javascript" src="js/Markdown.Editor.js"></script>
	<!--script type="text/javascript" src="js/prettify.js"></script-->
	<script type="text/javascript" src="js/Markdown.Extra.js"></script>

	<script type="text/javascript" src="js/raphael-min.js"></script>
	<script type="text/javascript" src="js/underscore-min.js"></script>
	<script type="text/javascript" src="js/sequence-diagram-min.js"></script>
	<script type="text/javascript" src="js/flowchart-latest.js"></script>
 

	<script type="text/javascript" src="js/markdown-display.js"></script>
	<!--link rel="stylesheet" href="css/markdown.css"></script-->

	<script type="text/javascript" src="js/theme.js"></script>

	<script src="js/jspdf.min.js"></script>
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>

	<script type="text/javascript" src="config.js"></script>

</head>
<body>

	<script id="markdown-display_on-the-fly-loader" ></script>
 
	<script  type="text/javascript">
	//<![CDATA[


		jQuery.support.cors = true;
		
		config.data.author.name = "Martin Salazard";
		config.data.author.email = "msalazard@externe.generali.fr";
	
		var useHistory = window.onpopstate && window.history.pushState;

		var themeConfigurator = new Theme.Configurator({
			post_process : {
				done : function(theme) {
					jQuery.growl.notice({title: "Theme changed", message: "New theme is '"+theme.label+"'"});
				},
				fail : function(theme, failures) {
					var message;
					if (failures.length>0) {
						message = "";
						var i;
						for ( i=0 ; i<failures.length ; i++ )
							message = message + "<li>"+failures[i].url+":"+failures[i].error+"</li>";
						message = "<ul>"+message+"</ul>";
					}
					jQuery.growl.warning({title: "Cannot set theme '"+theme.label+"' ("+theme.name+")", message: message});
				}
			},
			default_theme : 'pdofsi',
			themes : [
				new Theme.Reference('country','Country'),
				new Theme.Reference('deepocean','Deep Ocean'),
				new Theme.Reference('essay','Essay'),
				new Theme.Reference('galactic','Galactic'),
				new Theme.Reference('google','Google'),
				new Theme.Reference('stoneage','Stone Age'),
				new Theme.Reference('subtle','Subtle'),
				new Theme.Reference('terminal','Terminal'),
				new Theme.Reference('fuckit','Coco')
			],
			extra : {
				location : 'theme/generali/{0}',
				themes : [
					new Theme.Reference('pdofsi','PDO-FSI')
				]
			}
		});	

		function moveScroller() {
			var $anchor = $("body");
			var $scroller = $('#tools');

			var handleScroll = function() {
				var st = $(window).scrollTop();
				var ot = $anchor.offset().top;
				if (st > ot) {
					$scroller.css({
						position: "fixed",
						top: "1em", right : "1em"
					});
				} else {
					$scroller.css({
						position: "absolute",
						top: "", right : "1em"
					});
				}
			};
			$(window).scroll(handleScroll);
			handleScroll();
		}

		jQuery(function() {    
			var markdownBuilder = null;

			try {
				themeConfigurator.setup();
			} catch (ex) {
				jQuery.growl.warning({title: "Cannot set theme", message: ex});
			}
			moveScroller();
	
			var content_selector = "div.container>div.content";
			var title_selector = "span.title";
			var all_selector = content_selector+","+title_selector;

			var blockUI_config = {
				message : null,
				fadeIn  : 0,
				fadeOut : 1500,
				overlayCSS : {
					backgroundColor : '#fff',
					opacity : 1
				}
			};

			var build_result;

			var specialElementHandlers = {
				'#tools': function (element,renderer) {
					return true;
				}
			};

			jQuery('#download').click(function () {
				var doc = new jsPDF();
				doc.fromHTML(jQuery('div#exported-content').html(), 15, 15, {
					'width': 170,'elementHandlers': specialElementHandlers
				});
				doc.save((build_result?build_result.title:'untitled')+'.pdf');
			}).css('cursor','pointer');
			
			markdownBuilder = new MarkdownDisplay.Builder({
				content : {
					source : {
						url_parameter : 'md'
					},
					target : {
						title_selector : title_selector,
						content_selector : content_selector
					},
					nameToURLConverters : [
						MarkdownDisplay.config.NameToURLConverters.GITHUB,
						new MarkdownDisplay.NameToURLConverter ( /^generali\/~([^\/]+)\/([^\/]+)\/(.+)$/ , 'http://git.groupe.generali.fr/users/{0}/repos/{1}/browse/{2}?at=master&raw'),
						new MarkdownDisplay.NameToURLConverter ( /^generali\/([^\/]+)\/(.+)$/ , 'http://git.groupe.generali.fr/users/b010cdx/repos/{0}/browse/{1}?at=master&raw'),
						new MarkdownDisplay.NameToURLConverter ( /^livrable\/(.+)$/ , 'http://git.groupe.generali.fr/users/b010cdx/repos/document/browse/{0}?at=master&raw' )
					],
				},
				pre_process : {
					build : function(url) {
						jQuery(all_selector).css('visibility','hidden');
						return true;
					}
				},
				post_process : {
					done : function(url,content) {
						jQuery(content_selector).find('pre>code').each(function(i, block) {
							hljs.highlightBlock(block);
						});
						jQuery(all_selector).block(blockUI_config);
						jQuery(all_selector).css('visibility','visible').unblock(blockUI_config);
					},
					fail : function(url, error) {
						jQuery.growl.error({ title: "Load failed", fixed:true, message: "Loading '"+url+"' : "+error });
					}
				}
			});

			build_result = markdownBuilder.build();
		});
	//]]>
	</script>

	<div id="exported-content" style="text-align: center">
		<div style="display: inline-block; text-align: initial;">
			<table>
				<tr>
					<td>
						<header class="main-container" style="text-align: center">

							<div id="tools" class="reverse-boo" style="position:absolute; top:1em; right:1em;">
								<table>
									<tr>
										<td colspan="2">
											<select id="theme" />
										</td>
									</tr>
									<tr>
										<td>
											<a id="share">Sh</a>
										</td>
										<td>
											<a id="download">Dl</a>
										</td>
									</tr>
								</table>
							</div>

							<div style="display: inline-block; text-align: initial;">
								<table>
									<tr>
										<td>
											<!--img src="image/theme/logo-50px.png?raw" /-->
										</td>
										<td>
											<h1 class="title"><span class="title"></span></h1>
										</td>
										<td>
											<!--img src="image/theme/logo-50px.png" /-->
										</td>
									</tr>
								</table>
							</div>
						</header>
					</td>
				</tr>
				<tr>
					<td>
						<div class="main-container container"><div class="content markdown"></div></div>
					</td>
				</tr>
				<tr>
					<td>
						<footer class="main-container reverse-boo" style="font-size: 0.8em; text-align : center" >
							<span>
								Martin Der <br/>
								bla bla bla
							</span>
						</footer>
					</td>
				</tr>
			</table>
		</div>
	</div>
</body>
</html>
